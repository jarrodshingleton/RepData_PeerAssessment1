---
title: "Activity Monitoring Data Analysis"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(lubridate)
library(dplyr)
library(ggplot2)
library(lattice)
```

# Loading and preprocessing the data

The only different in the data is I changed the date column into a date object.
```{r}
data1<-read.csv("activity.csv")

#change to date/time object.
data1$date<-ymd(data1$date)

```

## What is mean total number of steps taken per day?

```{r}

steps_mean<-mean(data1$steps, na.rm=TRUE)
steps_mean
```


## Calculate the total number of steps taken per day

```{r}
daysteps<-data1%>%
  group_by(date)%>%
  summarize(day_steps=sum(steps, na.rm=TRUE))

daysteps
```


#Make a histogram of the total number of steps taken each day

```{r}
#removed the nas from the data set for this step

histdata<-data1[!is.na(data1$steps),]

g<-ggplot(histdata)+geom_histogram(aes(x=steps), binwidth=40)
g
```

## Calculate and report the mean and median of the total number of steps taken per day

```{r}

avgsteps<-data1%>%
  group_by(date)%>%
  summarise(mean_steps=mean(steps, na.rm=T), median_steps=median(steps, na.rm=T))

avgsteps
```

## What is the average daily activity pattern?

```{r}
activity<-data1%>%
  group_by(interval)%>%
  summarize(avg=mean(steps, na.rm=T))

g<-ggplot(activity)+geom_line(aes(x=interval, y=avg))+
  theme_bw()+ylab("Mean Steps")
g
```
# Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
activity[max(activity$avg),]
```
         
##Imputing missing values

I decided to use the average steps for the interval time to impute the values.

```{r}
dim(data1[is.na(data1$steps),])[1]

##seperated the data into na and not na
data2nona<-data1[!is.na(data1$steps),]
data2na<-data1[is.na(data1$steps),]

##merge the average values into the na data set
data2na<-data2na[,-1]
data2na<-left_join(data2na, activity)
data2na<-data2na[,c(3,1,2)]
names(data2na)[1]<-"steps"
data2na$steps<-round(data2na$steps, 0)

##put them both back together
data3<-rbind(data2nona, data2na)
data3<-data3%>%
  arrange(date, interval)
```

##Make a histogram of the total number of steps taken each day and  Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?

The only real difference I see is in some of the median values. No difference in the mean values.

```{r}
g<-ggplot(data3)+geom_histogram(aes(x=steps), bins=40)
g
```

```{r}
avgsteps2<-data3%>%
  group_by(date)%>%
  summarise(mean_steps=mean(steps, na.rm=T), median_steps=median(steps, na.rm=T))

avgsteps2
avgsteps
##
```



#Create a new factor variable in the dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.

```{r}
data3$wd<-weekdays(data3$date)
data3$daytype<-"Weekday"
data3$daytype[data3$wd=="Saturday"|data3$wd=="Sunday"]<-"Weekend"

```


#Make a panel plot containing a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). 

```{r}
plotdata<-data3%>%
  group_by(daytype, interval)%>%
  summarize(steps=mean(steps))


with(plotdata, xyplot(steps~interval|factor(daytype), type="l", layout=c(1,2)))
```
